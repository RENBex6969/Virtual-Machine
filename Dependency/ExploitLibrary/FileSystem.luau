local FS = require("@lune/fs")
local Directory = "Workspace/"

FS.writeDir(Directory)

local function ensurePathExists(Path)
  local Parts = {}
  for Part in Path:gmatch("[^/]+") do
    table.insert(Parts, Part)
  end
  table.remove(Parts)
  local Current = Directory
  for _, Part in ipairs(Parts) do
    Current = Current .. Part .. "/"
    FS.writeDir(Current)
  end
end

local FileSystem; FileSystem = {
  readfile = function(Path)
    return FS.readFile(Directory .. Path)
  end,
  writefile = function(Path, Content)
    ensurePathExists(Path)
    return FS.writeFile(Directory .. Path, Content)
  end,
  isfile = function(Path)
    return FS.isFile(Directory .. Path)
  end,
  makefolder = function(Path)
    return FS.writeDir(Directory .. Path)
  end,
  isfolder = function(Path)
    local succ, err = pcall(FS.readDir, Directory .. Path)
    if succ == true then
      return true
    else
      return false
    end
  end,
  delfile = function(Path)
    return FS.removeFile(Directory .. Path)
  end,
  delfolder = function(Path)
    return FS.removeDir(Directory .. Path)
  end,
  appendfile = function(Path, Message)
    local fullPath = Directory .. Path
    ensurePathExists(Path)
    local Existing = ""
    if FS.isFile(fullPath) then
      Existing = FS.readFile(fullPath)
    end
    local Final = Existing .. Message
    return FS.writeFile(fullPath, Final)
  end,
  listfiles = function(Path)
    local Files = FS.readDir(Directory .. Path)
    local CompiledFiles = {}
    table.foreach(Files, function(_, Value)
      table.insert(CompiledFiles, Path .. "/" .. Value)
    end)
    return CompiledFiles
  end,
  dofile = function() end,
  loadfile = function() end
}

return FileSystem
